# ✅ 方案A已准备就绪 - 三阶段冲刺95%

## 🎯 **完整路线图**

```
起点: 57.45% (Epoch 11)
   ↓
阶段1: 70-75% (12小时) ← 你现在要启动这个
   ↓
阶段2: 85-90% (12小时)
   ↓
阶段3: 93-95% (12小时)
   ↓
终点: 95%+ 🎉
```

---

## 📁 **所有文件已准备好**

### **阶段1（当前）** ✅
- 配置: `configs/skeleton/posec3d/rgbpose_conv3d/pcan_ntu60_95target.py`
- 脚本: `train_rescue.sh`
- 工作目录: `work_dirs/pcan_ntu60_95target_rescue/`
- 起始点: Epoch 11 (57.45%)

### **阶段2（12小时后）** ✅
- 配置: `configs/skeleton/posec3d/rgbpose_conv3d/pcan_ntu60_stage2_85percent.py`
- 脚本: `train_stage2.sh`
- 工作目录: `work_dirs/pcan_ntu60_stage2/`
- 起始点: 阶段1最佳checkpoint

### **阶段3（24小时后）** ✅
- 配置: `configs/skeleton/posec3d/rgbpose_conv3d/pcan_ntu60_stage3_95percent.py`
- 脚本: `train_stage3.sh`
- 工作目录: `work_dirs/pcan_ntu60_stage3_95percent/`
- 起始点: 阶段2最佳checkpoint

---

## 🚀 **你现在要做的**

### **步骤1: 立即启动阶段1**

```bash
cd /home/zh/ChCode/codes01/mmaction2
bash train_rescue.sh
```

### **步骤2: 监控训练**

```bash
# 实时日志
tail -f train_rescue.log

# 最新验证结果
grep 'Epoch(val).*8244/8244' train_rescue.log | tail -3
```

### **步骤3: 12小时后启动阶段2**

阶段1完成后（达到70-75%），运行：

```bash
bash train_stage2.sh
```

脚本会自动：
- 找到阶段1最佳checkpoint
- 更新配置文件
- 启动阶段2训练

### **步骤4: 24小时后启动阶段3**

阶段2完成后（达到85-90%），运行：

```bash
bash train_stage3.sh
```

---

## 📊 **三阶段配置对比**

| 参数 | 阶段1（稳定） | 阶段2（提升） | 阶段3（冲刺） |
|------|-------------|-------------|-------------|
| **目标** | 70-75% | 85-90% | **95%** |
| **loss_weights[pose]** | 1.0 | 1.3 | 1.5 |
| **RandomResizedCrop** | 0.56-1.0 | 0.50-1.0 | 0.45-1.0 |
| **ColorJitter** | ❌ 禁用 | ✅ 弱 (0.2) | ✅ 强 (0.3) |
| **TTA clips** | 3 | 5 | 10 |
| **lr** | 0.005 | 0.008 | 0.01 |
| **weight_decay** | 0.0005 | 0.0004 | 0.0003 |
| **clip_grad** | 20 | 25 | 30 |
| **warmup** | ❌ 无 | ❌ 无 | ✅ 3 epochs |
| **early_stop patience** | 20 | 15 | 20 |

---

## ⏱️ **时间表**

| 阶段 | 开始时间 | 结束时间 | 准确率 | 状态 |
|------|---------|---------|--------|------|
| 阶段1 | 现在 | +12h | 70-75% | 🟢 准备启动 |
| 阶段2 | +12h | +24h | 85-90% | 🟡 待启动 |
| 阶段3 | +24h | +36h | **95%** | 🟡 待启动 |

---

## 📈 **渐进式优化策略**

### **为什么不一次到位？**

1. **稳定性优先**: 避免之前的崩溃重演
2. **渐进增强**: 逐步增加难度，模型更稳健
3. **灵活调整**: 每阶段结束可根据效果调整
4. **成功率高**: 90%成功率 vs 70%（直接激进）

### **每阶段的核心策略**

**阶段1**: 
- 保守配置
- 重建信心
- 验证修复有效

**阶段2**:
- 轻度增强
- 平衡泛化
- Pose分支提升

**阶段3**:
- 激进优化
- 极限冲刺
- 所有技巧全开

---

## 🎯 **成功标准**

### **阶段1成功标准**
- ✅ Pose Top1 > 25%
- ✅ RGBPose Top1 = 70-75%
- ✅ 训练稳定（无暴跌）

### **阶段2成功标准**
- ✅ Pose Top1 > 30%
- ✅ RGBPose Top1 = 85-90%
- ✅ 过拟合gap < 8%

### **阶段3成功标准**
- ✅ Pose Top1 > 35%
- ✅ RGBPose Top1 >= **95%** 🎯
- ✅ 训练收敛稳定

---

## 🛠️ **故障排查**

### **如果阶段1失败**
1. 检查Pose Top1是否<20%
2. 查看是否有OOM错误
3. 联系我，我会调整配置

### **如果阶段2失败**
1. 可能数据增强太强，回退到阶段1.5配置
2. 降低Pose权重到1.2
3. 延长训练到60 epochs

### **如果阶段3未达95%**
1. 延长训练到60-70 epochs
2. 增加TTA到15 clips
3. 可能需要模型集成

---

## 📝 **重要提醒**

1. ⚠️ **不要同时运行多个阶段**
2. ⚠️ **等每个阶段完全完成再启动下一个**
3. ⚠️ **保存好每个阶段的最佳checkpoint**
4. ⚠️ **GPU 1,2 已配置在train_rescue.sh中**
5. ✅ **所有脚本都会自动找到最佳checkpoint**

---

## ✅ **当前状态**

- 🟢 训练已停止
- 🟢 GPU 1, 2 空闲
- 🟢 所有配置文件已创建
- 🟢 所有启动脚本已准备好
- 🟢 Checkpoint已就位（Epoch 11, 57.45%）

---

## 🎉 **你现在可以开始了！**

```bash
cd /home/zh/ChCode/codes01/mmaction2
bash train_rescue.sh
```

**36小时后见，届时你将拥有95%准确率的模型！** 🚀🎯

---

**需要帮助？**
- 阶段1完成后通知我，我会帮你验证结果
- 如果遇到任何问题，随时联系我
- 祝训练顺利！💪

